<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  /* Existing styles */
  body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      background-color: #f4f4f4;
  }

  h1 {
      text-align: center;
  }

  .chord-selection {
      margin: 10px;
  }

  

   


  select {
    max-width: 300px;
    width: 100%;
    padding: 12px; /* Increased padding for larger touch targets */
    margin: 5px 0;
    font-size: 1.2em; /* Increased font size */
    font-weight: bold; /* Make text bold */
    background-color: #e0e0e0; /* A light grey background for visibility */
    border: 1px solid #c0c0c0; /* A subtle border */
    border-radius: 4px; /* Rounded corners for aesthetic */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add shadow here */
    font-size: inherit; 
/* Transition for a smooth hover effect */
transition: box-shadow 0.3s ease-in-out;
}

/* Enhance shadow on hover for better interaction feedback */
select:hover {
box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
}


  #keyDisplay {
    white-space: nowrap; /* Prevent text from wrapping onto the next line */
    overflow: hidden;   /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis if text is too long */
    font-size: 2vw; /* Adjust this value as needed */
}

@media (max-width: 768px) {
    #keyDisplay {
        font-size: 3vw; /* Smaller font size for smaller devices */
    }
  
    select {
        font-size: 1.5em; /* Even larger font size for mobile devices */
        padding: 15px; /* Slightly larger padding */
    }
}

@media (max-width: 480px) {
    #keyDisplay {
        font-size: 2vw; /* Even smaller font size for very small devices */
    }
    select {
        font-size: 1.5em; /* Even larger font size for mobile devices */
        padding: 15px; /* Slightly larger padding */
    }


}
/* Adjustments for Mobile */
 
</style>
<title>Song Key Finder _2024</title>
</head>
<body>

<h2>Song Key Finder</h2>
<h3>Select 3-6 chords from your song to find out the key</h3>

 
<div id="chords">
    <!-- Chord Selector 1 -->
    <div class="chord-selection">
      <select id="chord1Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord1Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
        <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
     
      </select>
    </div>
    
    <br>
    <!-- Chord Selector 2 -->
    <div class="chord-selection">
      <select id="chord2Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord2Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
         <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
      </select>
   
    </div>
  
   <br>
   <!-- Chord Selector 3 -->
    <div class="chord-selection">
      <select id="chord3Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord3Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
        <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
        <br>
      </select>
  
    </div>

  <br>

  <!-- Chord Selector 4 -->
    <div class="chord-selection">
      <select id="chord4Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord4Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
        <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
        <br>
      </select>
    </div>
  <br>


 <!-- Chord Selector 5 -->
    <div class="chord-selection">
      <select id="chord5Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord5Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
        <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
        <br>
      </select>
    </div>
  <br>
 <!-- Chord Selector 6 -->
    <div class="chord-selection">
      <select id="chord6Note">
        <option value="">Select Chord</option>
        <option value="00">C</option>
        <option value="01">C#/Db</option>
        <option value="02">D</option>
        <option value="03">D#/Eb</option>
        <option value="04">E</option>
        <option value="05">F</option>
        <option value="06">F#/Gb</option>
        <option value="07">G</option>
        <option value="08">G#/Ab</option>
        <option value="09">A</option>
        <option value="10">A#/Bb</option>
        <option value="11">B</option>
      </select>
      <select id="chord6Quality">
        <option value="">Select Chord Quality</option>
        <option value="0">Major (△, ma7, ma9, 6, <i>& 1st note in a / chord</i>)</option>
        <option value="3">Minor</option>
        <option value="5">Dominant (7, 9, 11, 13)</option>
        <option value="7">Diminished/mi7b5</option>
        <br>
      </select>
    </div>

</form>






<p id="keyDisplay">↑Select the chords of your song </p>
then Go to <a href="https://drive.google.com/file/d/1xgGTwJ9qIn_qc4lItU-5c7BN4zv5TEdo/view?usp=sharing" target="_blank">Harmonized Major Scales - the chords in all the keys</a>
and
<a href="https://toddmccool.github.io/chordprog124/index.html#basicApp" target="_blank">todd's Pop Progression Finder</a>.


<script>

// Note and Chord Quality Mappings
var noteMapping = {
    'C': '00', 'C#/Db': '01', 'D': '02', 'D#/Eb': '03', 'E': '04',
    'F': '05', 'F#/Gb': '06', 'G': '07', 'G#/Ab': '08', 'A': '09', 'A#/Bb': '10', 'B': '11'
};

var chordQualityMapping = {
    'Major': '0',
    'Minor': '3',
    'Dominant': '5',
    'Diminished': '7'
};
var keyChordMapping = {
    'C major : <sup>(I)</sup> C - <sup>(ii)</sup> Dmi - <sup>(iii)</sup> Emi - <sup>(IV)</sup> F __ F7 <sup>(V)</sup> G __ G7 <sup>(vi)</sup> Ami - <sup>(vii)</sup> Bdim __Bmi7b5__G/B <br>': ['000', '023', '043', '050', '070', '075', '093', '117'],
    'Db major : <sup>(I)</sup> Db - <sup>(ii)</sup> Ebmi - <sup>(iii)</sup> Fmi - <sup>(IV)</sup> Gb __ Gb7 <sup>(V)</sup> Ab __ Ab7 <sup>(vi)</sup> Bbmi - <sup>(vii)</sup> Cdim __Cmi7b5__Ab/C <br>': ['010', '033', '053', '060', '080', '085', '103', '007'],
    'D major : <sup>(I)</sup> D - <sup>(ii)</sup> Emi - <sup>(iii)</sup> F#mi - <sup>(IV)</sup> G __ G7 <sup>(V)</sup> A __ A7 <sup>(vi)</sup> Bmi - <sup>(vii)</sup> C#dim __C#mi7b5__A/C# <br>': ['020', '043', '063', '070', '090', '095', '113', '017'],
    'Eb major : <sup>(I)</sup> Eb - <sup>(ii)</sup> Fmi - <sup>(iii)</sup> Gmi - <sup>(IV)</sup> Ab __ Ab7 <sup>(V)</sup> Bb __ Bb7 <sup>(vi)</sup> Cmi - <sup>(vii)</sup> Ddim __Dmi7b5__Bb/D <br>': ['030', '053', '073', '080', '100', '105', '003', '027'],
    'E major : <sup>(I)</sup> E - <sup>(ii)</sup> F#mi - <sup>(iii)</sup> G#mi - <sup>(IV)</sup> A __ A7 <sup>(V)</sup> B __ B7 <sup>(vi)</sup> C#mi - <sup>(vii)</sup> D#dim __D#mi7b5__B/D# <br>': ['040', '063', '083', '090', '110', '115', '013', '037'],
    'F major : <sup>(I)</sup> F - <sup>(ii)</sup> Gmi - <sup>(iii)</sup> Ami - <sup>(IV)</sup> Bb __ Bb7 <sup>(V)</sup> C __ C7 <sup>(vi)</sup> Dmi - <sup>(vii)</sup> Edim __Emi7b5__C/E <br>': ['050', '073', '093', '100', '120', '125', '023', '047'],
    'Gb major : <sup>(I)</sup> Gb - <sup>(ii)</sup> Abmi - <sup>(iii)</sup> Bbmi - <sup>(IV)</sup> B __ B7 <sup>(V)</sup> Db __ Db7 <sup>(vi)</sup> Ebmi - <sup>(vii)</sup> Fdim __Fmi7b5__Db/F <br>': ['060', '083', '103', '110', '010', '015', '033', '057'],
    'G major : <sup>(I)</sup> G - <sup>(ii)</sup> Ami - <sup>(iii)</sup> Bmi - <sup>(IV)</sup> C __ C7 <sup>(V)</sup> D __ D7 <sup>(vi)</sup> Emi - <sup>(vii)</sup> F#dim __F#mi7b5__D/F# <br>': ['070', '093', '113', '000', '020', '025', '043', '067'],
    'Ab major : <sup>(I)</sup> Ab - <sup>(ii)</sup> Bbmi - <sup>(iii)</sup> Cmi - <sup>(IV)</sup> Db __ Db7 <sup>(V)</sup> Eb __ Eb7 <sup>(vi)</sup> Fmi - <sup>(vii)</sup> Gdim __Gmi7b5__Eb/G <br>': ['080', '103', '123', '130', '030', '035', '053', '077'],
    'A major : <sup>(I)</sup> A - <sup>(ii)</sup> Bmi - <sup>(iii)</sup> C#mi - <sup>(IV)</sup> D __ D7 <sup>(V)</sup> E __ E7 <sup>(vi)</sup> F#mi - <sup>(vii)</sup> G#dim __G#mi7b5__E/G# <br>': ['090', '113', '133', '140', '160', '045', '063', '087'],
    'Bb major : <sup>(I)</sup> Bb - <sup>(ii)</sup> Cmi - <sup>(iii)</sup> Dmi - <sup>(IV)</sup> Eb __ Eb7 <sup>(V)</sup> F __ F7 <sup>(vi)</sup> Gmi - <sup>(vii)</sup> Adim __Ami7b5__F/A <br>': ['100', '003', '023', '030', '050', '055', '073', '097'],
    'B major : <sup>(I)</sup> B - <sup>(ii)</sup> C#mi - <sup>(iii)</sup> D#mi - <sup>(IV)</sup> E __ E7 <sup>(V)</sup> F# __ F#7 <sup>(vi)</sup> G#mi - <sup>(vii)</sup> A#dim __A#mi7b5__F#/A# <br>': ['110', '013', '040', '180', '065', '083', '107'],

    'C major with a jazzy/melodic Fmi (iv)': ['000', '023', '043', '050', '053', '070', '075', '093', '117'],
    'Db major with a jazzy/melodic Gbmi (iv)': ['010', '033', '053', '060', '063', '080', '085', '103', '007'],
    'D major with a jazzy/melodic Gmi (iv)': ['020', '043', '063', '070', '073', '090', '095', '113', '017'],
    'Eb major with a jazzy/melodic Abmi (iv)': ['030', '053', '073', '080', '083', '100', '105', '003', '027'], // D#/Eb major: D#, Gm, Abm, G#, A#, A#7, Cm, Fm (Ddim replaced with Fm)
    'E major with a jazzy/melodic Ami (iv)': ['040', '063', '083', '090', '093','110', '115', '013', '037'], // E major: E, Am, Bbm, A, B, B7, C#m, G#m (G#dim replaced with G#m)
    'F major with a jazzy/melodic Bbmi (iv)': ['050', '073', '093', '100', '103','120', '125', '023', '047'], // F major: F, Gm, Am, Bb, C, C7, Dm, A#m (Edim replaced with A#m)
    'Gb major with a jazzy/melodic Bmi (iv)': ['060', '083', '103', '110', '113','010', '015', '033', '057'], // F#/Gb major: F#, G#m, A#m, B, C#, C#7, D#m, Bm (Fdim replaced with Bm)
    'G major with a jazzy/melodic Cmi (iv)': ['070', '093', '113', '000', '003', '020', '025', '043', '067'], // G major: G, Am, Bm, C, D, D7, Em, Cm (Ebdim replaced with Cm)
    'Ab major with a jazzy/melodic Dbmi (iv)': ['080', '103', '123', '010', '013', '030', '035', '053', '077'], // G#/Ab major: G#, A#m, Cm, C#, D#, D#7, Fm, Dm (Gdim replaced with Dm)
    'A major with a jazzy/melodic Dmi (iv)': ['090', '113', '133', '140', '143', '160', '045', '063', '087'], // A major: A, Bm, C#m, D, E, E7, F#m, Em (Adim replaced with Em)
    'Bb major with a jazzy/melodic Ebmi (iv)': ['100', '003', '023', '030', '033', '050', '055', '073', '097'], // A#/Bb major: A#, Cm, Dm, D#, F, F7, Gm, Fm (Cdim replaced with Fm)
    'B major with a jazzy/melodic Emi (iv)': ['110', '013', '003', '040', '043', '180', '065', '083', '107'] , // B major: B, C#m, D#m, E, F#, F#7, G#m, Em (Bbdim replaced with Em)








     'C Lydian - C major scale with D(7) (II)': ['000',  '020', '043', '050', '070', '075', '093', '117'], // C major: C, Dm, F, G, G7, Am, Em, Bdim
    'Db Lydian - Db major scale with B(7) (II)': ['010', '033', '030', '053', '060', '080', '085', '103', '007'], // C#/Db major: C#, D#m, F#, G#, G#7, A#m, Fm, Bdim
    'D Lydian - D major scale with C(7) (II)': ['020', '043', '040', '063', '070', '090', '095', '113', '017'], // D major: D, Em, G, A, A7, Bm, F#m, C#dim
    'Eb Lydian - Eb major scale with F(7) (II)': ['030', '053', '050', '073', '080', '100', '105', '003', '027'], // D#/Eb major: D#, Gm, Abm, G#, A#, A#7, Cm, Fm (Ddim replaced with Fm)
    'E Lydian - E major scale with F#(7) (II)': ['040', '063', '060', '083', '090', '110', '115', '013', '037'], // E major: E, Am, Bbm, A, B, B7, C#m, G#m (G#dim replaced with G#m)
    'F Lydian - F major scale with G(7) (II)': ['050', '073', '070', '093', '100', '120', '125', '023', '047'], // F major: F, Gm, Am, Bb, C, C7, Dm, A#m (Edim replaced with A#m)
    'Gb Lydian - Gb major scale with E(7) (II)': ['060', '083', '080', '103', '110', '010', '015', '033', '057'], // F#/Gb major: F#, G#m, A#m, B, C#, C#7, D#m, Bm (Fdim replaced with Bm)
    'G Lydian - G major scale with F(7) (II)': ['070', '093', '090', '113', '000', '020', '025', '043', '067'], // G major: G, Am, Bm, C, D, D7, Em, Cm (Ebdim replaced with Cm)
    'Ab Lydian - Ab major scale with Gb(7) (II)': ['080', '103', '100', '123', '130', '030', '035', '053', '077'], // G#/Ab major: G#, A#m, Cm, C#, D#, D#7, Fm, Dm (Gdim replaced with Dm)
    'A Lydian - A major scale with G(7) (II)': ['090', '113', '110', '133', '140', '160', '045', '063', '087'], // A major: A, Bm, C#m, D, E, E7, F#m, Em (Adim replaced with Em)
    'Bb Lydian - Bb major scale with Ab(7) (II)': ['100', '003', '000', '023', '030', '050', '055', '073', '097'], // A#/Bb major: A#, Cm, Dm, D#, F, F7, Gm, Fm (Cdim replaced with Fm)
    'B Lydian - B major scale with A(7) (II)': ['110', '013', '010', '003', '013', '180', '065', '083', '107'] , // B major: B, C#m, D#m, E, F#, F#7, G#m, Em (Bbdim replaced with Em)

     'G mixoLydian - G major scale with F(7) (bVII)': ['000', '023', '020', '043', '050', '070', '075', '093', '117'], // C major: C, Dm, F, G, G7, Am, Em, Bdim
    'Ab mixoLydian - Ab major scale with Gb(7) (bVII)': ['010', '033', '030', '053', '060', '080', '085', '103', '007'], // C#/Db major: C#, D#m, F#, G#, G#7, A#m, Fm, Bdim
    'A mixoLydian - A major scale with G(7) (bVII)': ['020', '043', '040', '063', '070', '090', '095', '113', '017'], // D major: D, Em, G, A, A7, Bm, F#m, C#dim
    'Bb mixoLydian - Bb major scale with Ab(7) (bVII)': ['030', '053', '050', '073', '080', '100', '105', '003', '027'], // D#/Eb major: D#, Gm, Abm, G#, A#, A#7, Cm, Fm (Ddim replaced with Fm)
    'B mixoLydian - B major scale with A(7) (bVII)': ['040', '063', '060', '083', '090', '110', '115', '013', '037'], // E major: E, Am, Bbm, A, B, B7, C#m, G#m (G#dim replaced with G#m)
    
    
    'C mixoLydian - C major scale with Bb(7) (bVII)': ['050', '073', '070', '093', '000','100', '120', '125', '023', '047'], 
    

   


    // F major: F, Gm, Am, Bb, C, C7, Dm, A#m (Edim replaced with A#m)
    'Db mixoLydian - Db major scale with B(7) (bVII)': ['060', '083', '080', '103', '110', '010', '015', '033', '057'], // F#/Gb major: F#, G#m, A#m, B, C#, C#7, D#m, Bm (Fdim replaced with Bm)
    'D mixoLydian - D major scale with C(7) (bVII)': ['070', '093', '090', '113', '000', '020', '025', '043', '067'], // G major: G, Am, Bm, C, D, D7, Em, Cm (Ebdim replaced with Cm)
    'Eb mixoLydian - Eb major scale with Db(7) (bVII)': ['080', '103', '100', '123', '130', '030', '035', '053', '077'], // G#/Ab major: G#, A#m, Cm, C#, D#, D#7, Fm, Dm (Gdim replaced with Dm)
    'E mixoLydian - E major scale with D(7) (bVII)': ['090', '113', '110', '133', '140', '160', '045', '063', '087'], // A major: A, Bm, C#m, D, E, E7, F#m, Em (Adim replaced with Em)
    'F mixoLydian - F major scale with Eb(7) (bVII)': ['100', '003', '000', '023', '030', '050', '055', '073', '097'], // A#/Bb major: A#, Cm, Dm, D#, F, F7, Gm, Fm (Cdim replaced with Fm)
    'Gb mixoLydian - Gb major scale with E(7) (bVII)': ['110', '013', '010', '003', '013', '180', '065', '083', '107'] , // B major: B, C#m, D#m, E, F#, F#7, G#m, Em (Bbdim replaced with Em)

    'C# harmonic minor (Spanish) or E Phrygian Dominant (E Major with a Soulful III or III7)': ['013', '040', '063', '090', '080', '085'], // C#/Db harmonic minor: C#m, F#m, A, G#, G#7
    'D harmonic minor (Spanish) or F Phrygian Dominant (F Major with a Soulful III or III7)': ['023', '050', '073', '100', '090', '095'], // D harmonic minor: Dm, Gm, Bb, A, A7
    'Eb harmonic minor (Spanish) or Gb Phrygian Dominant (Gb Major with a Soulful III or III7)': ['033', '060', '083', '110', '100', '105'], // D#/Eb harmonic minor: Ebm, Abm, B, Bb, Bb7
    'E harmonic minor (Spanish) or G Phrygian Dominant (G Major with a Soulful III or III7)': ['043', '070', '093', '000', '110', '115'], // E harmonic minor: Em, Am, C, B, B7
    'F harmonic minor (Spanish) or Ab Phrygian Dominant (Ab Major with a Soulful III or III7)': ['053', '080', '103', '010', '000', '005'], // F harmonic minor: Fm, Bbm, Db, C, C7
    'Gb harmonic minor (Spanish) or A Phrygian Dominant (A Major with a Soulful III or III7)': ['063', '090', '113', '020', '010', '015'], // F#/Gb harmonic minor: F#m, Bm, D, C#, D7
    'G harmonic minor (Spanish) or Bb Phrygian Dominant (Bb Major with a Soulful III or III7)': ['073', '100', '003', '030', '020', '025'], // G harmonic minor: Gm, Cm, Eb, D, D7
    'Ab harmonic minor (Spanish) or B Phrygian Dominant (B Major with a Soulful III or III7)': ['083', '110', '013', '040', '030', '035'], // G#/Ab harmonic minor: G#m, C#m, E, Eb, E7
    'A harmonic minor (Spanish) or C Phrygian Dominant (C Major with a Soulful III or III7)': ['093', '000', '023', '050', '040', '045'], // A harmonic minor: Am, Dm, F, E, E7
    'Bb harmonic minor (Spanish) or Db Phrygian Dominant (Db Major with a Soulful III or III7)': ['103', '010', '033', '060', '050', '055'], // A#/Bb harmonic minor: Bbm, Ebm, F#, F, F7
    'B harmonic minor (Spanish) or D Phrygian Dominant (D Major with a Soulful III or III7)': ['113', '020', '043', '070', '060', '065'] // B harmonic minor: Bm, Em, G, F#, G7
};




var invalidChordCombos = {
  /* exludes a combo of the I ii and bVII */ 
  'C Lydian - C major scale with D(7) (II)': ['023', '100'],  
    'Db Lydian - Db major scale with B(7) (II)': ['033', '110'],  
    'D Lydian - D major scale with C(7) (II)': ['043', '000'],  
    'Eb Lydian - Eb major scale with F(7) (II)': ['053', '010'],  
    'E Lydian - E major scale with F#(7) (II)': ['063', '020'],
    'F Lydian - F major scale with G(7) (II)': ['073', '030'],
    'Gb Lydian - Gb major scale with E(7) (II)': ['083', '040'],
    'G Lydian - G major scale with F(7) (II)': ['093', '050'],
    'Ab Lydian - Ab major scale with Gb(7) (II)': ['103', '060'],
    'A Lydian - A major scale with G(7) (II)': ['113', '070'],
    'Bb Lydian - Bb major scale with Ab(7) (II)': ['003', '080'],
    'B Lydian - B major scale with A(7) (II)': ['013', '090'],


     /* exludes a combo of the I II and bVII */ 
     'G mixoLydian - G major scale with F(7) (bVII)': ['053'], // C major: C, Dm, F, G, G7, Am, Em, Bdim
    'Ab mixoLydian - Ab major scale with Gb(7) (bVII)': ['063'],  
    'A mixoLydian - A major scale with G(7) (bVII)': ['073'], 
    'Bb mixoLydian - Bb major scale with Ab(7) (bVII)': ['083'],  
    'B mixoLydian - B major scale with A(7) (bVII)': ['093'], 
    'C mixoLydian - C major scale with Bb(7) (bVII)':  ['103'], 
    'Db mixoLydian - Db major scale with B(7) (bVII)':  ['113'], 
    'D mixoLydian - D major scale with C(7) (bVII)':  ['003'], 
    'Eb mixoLydian - Eb major scale with Db(7) (bVII)':  ['013'], 
    'E mixoLydian - E major scale with D(7) (bVII)':  ['023'], 
    'F mixoLydian - F major scale with Eb(7) (bVII)':  ['033'], 
    'Gb mixoLydian - Gb major scale with E(7) (bVII)':  ['043'], 
};
// Combine note and quality to get chord encoding
function combineNoteAndQuality(note, quality) {
    return note + quality;
}


function adjustChordSelectorsSize() {
    const keyDisplayText = document.getElementById('keyDisplay').textContent;
    const chordSelectors = document.querySelectorAll('.chord-selection select');
    const newSize = keyDisplayText ? '0.8em' : '1.2em'; // 0.8em is 2/3 of 1.2em

    chordSelectors.forEach(select => {
        select.style.fontSize = newSize;
    });
}


function findPossibleKeys(selectedChords) {
    let possibleKeys = [];
    console.log("Selected chords: ", selectedChords);

    Object.keys(keyChordMapping).forEach(key => {
        console.log("Testing key: ", key);
        const isKeyMatch = selectedChords.every(chord => keyChordMapping[key].includes(chord));
        console.log("Is Key Match: ", isKeyMatch);

        // Modified line for invalid chord check
        const hasInvalidChords = invalidChordCombos[key] ? invalidChordCombos[key].some(invalidChord => selectedChords.includes(invalidChord)) : false;
        console.log("Has Invalid Chords: ", hasInvalidChords);

        if (isKeyMatch && !hasInvalidChords) {
            possibleKeys.push(key);
        }
    });
    console.log("Possible keys: ", possibleKeys);
    return possibleKeys;
}

function updateKeyDisplay() {
    let selectedChords = [];
    for (let i = 1; i <= 6; i++) {
        const chordNote = document.getElementById(`chord${i}Note`).value;
        const chordQuality = document.getElementById(`chord${i}Quality`).value;
        if (chordNote && chordQuality) {
            selectedChords.push(combineNoteAndQuality(chordNote, chordQuality));
        }
    }

    if (selectedChords.length >= 3) {
        const possibleKeys = findPossibleKeys(selectedChords);
        if (possibleKeys.length > 0) {
            document.getElementById('keyDisplay').innerHTML = 'Possible keys <i>(in order of likelihood and complexity)</i>:<br>' + possibleKeys.join('<br>');
        } else {
            document.getElementById('keyDisplay').textContent = 'No matching key found. The Song may modulate or be in multiple keys, Please revise selections or enter more chords or just the chords from a single section .';
        }
    } else {
    document.getElementById('keyDisplay').textContent = 'Select at least 3 chords to find possible keys.';
} 
adjustChordSelectorsSize();  
}


document.addEventListener('DOMContentLoaded', () => {
    for (let i = 1; i <= 6; i++) {
        document.getElementById(`chord${i}Note`).addEventListener('change', updateKeyDisplay);
        document.getElementById(`chord${i}Quality`).addEventListener('change', updateKeyDisplay);
    }
});

</script>
</body>

</html>